<!DOCTYPE html>
<html lang="km">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>កម្មវិធីស្នើសុំច្បាប់</title>

    <!-- 1. ផ្ទុក Tailwind CSS សម្រាប់ Styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* ប្រើ Font ខ្មែរដែលងាយស្រួលអាន */
        body {
            font-family: 'Inter', 'Khmer OS Siemreap', sans-serif;
        }
        /* លាក់ scrollbar របស់ browser តែនៅតែអាច scroll បាន */
        .no-scrollbar::-webkit-scrollbar {
            display: none;
        }
        .no-scrollbar {
            -ms-overflow-style: none; /* IE and Edge */
            scrollbar-width: none; /* Firefox */
        }
    </style>

    <!-- 2. ផ្ទុក React, ReactDOM, and Babel -->
    <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- 3. ផ្ទុក Firebase SDKs (v9 Modular) -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-app.js";
        // SDK សម្រាប់ Database 1 (dilistname)
        import { getDatabase, ref, onValue } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-database.js";
        // SDK សម្រាប់ Database 2 (dipermisstion)
        import { getFirestore, collection, addDoc, onSnapshot, serverTimestamp as firestoreServerTimestamp, Timestamp } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore.js";

        
        // ដាក់ global variables ដើម្បីអោយ React អាចប្រើបាន
        window.firebase = {
            initializeApp,
            // Realtime DB functions
            getDatabase,
            ref,
            onValue,
            // Firestore functions
            getFirestore,
            collection,
            addDoc,
            onSnapshot,
            firestoreServerTimestamp,
            Timestamp
        };

        // --- Firebase Configs ---
        
        // Firebase 1: សម្រាប់អានបញ្ជីឈ្មោះ
        window.firebaseConfigList = {
            apiKey: "AIzaSyAc2g-t9A7du3K_nI2fJnw_OGxhmLfpP6s",
            authDomain: "dilistname.firebaseapp.com",
            databaseURL: "https://dilistname-default-rtdb.firebaseio.com",
            projectId: "dilistname",
            storageBucket: "dilistname.firebasestorage.app",
            messagingSenderId: "897983357871",
            appId: "1:897983357871:web:42a046bc9fb3e0543dc55a",
            measurementId: "G-NQ798D9J6K"
        };

        // Firebase 2: សម្រាប់រក្សាទុកទិន្នន័យច្បាប់
        window.firebaseConfigPermissions = {
            apiKey: "AIzaSyDjr_Ha2RxOWEumjEeSdluIW3JmyM76mVk",
            authDomain: "dipermisstion.firebaseapp.com",
            projectId: "dipermisstion",
            storageBucket: "dipermisstion.firebasestorage.app",
            messagingSenderId: "512999406057",
            appId: "1:512999406057:web:953a2b1ab9dde7a9a0f378",
            measurementId: "G-KDPHXZ7H4B",
            databaseURL: "https://dipermisstion-default-rtdb.firebaseio.com"
        };
        
        // បង្ខំឲ្យប្រើ 'default-app-id' ដើម្បីឲ្យត្រូវនឹងទិន្នន័យចាស់
        window.appId = 'default-app-id';

    </script>
</head>
<body class="bg-gray-200">

    <!-- ទីតាំងដែល React នឹង render កម្មវិធី -->
    <div id="root" class="no-scrollbar"></div>

    <!-- 4. កូដ React (JSX) របស់យើងត្រូវបានដាក់ក្នុង File ផ្សេង -->
    <script type="text/babel" src="app.jsx"></script>

    <!-- 5. Script សម្រាប់ដំណើរការកម្មវិធី (Bootstrapping) -->
    <script type="text/babel">
        const { StrictMode } = React;
        
        // Render the App
        // យើងសន្មត់ថា App function ត្រូវបានកំណត់នៅក្នុង app.jsx ហើយ
        window.onload = function() {
            if (typeof App !== 'undefined') {
                const root = ReactDOM.createRoot(document.getElementById('root'));
                root.render(
                    <StrictMode>
                        <App />
                    </StrictMode>
                );
            } else {
                console.error("App component not found. Check app.jsx loading.");
            }
        };
    </script>

</body>
</html>
